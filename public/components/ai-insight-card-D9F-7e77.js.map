{"version":3,"file":"ai-insight-card-D9F-7e77.js","sources":["../../../node_modules/.pnpm/@lit+reactive-element@2.1.1/node_modules/@lit/reactive-element/decorators/state.js","../src/types/events.ts","../src/components/ai-insight-card/ai-insight-card.ts"],"sourcesContent":["import{property as t}from\"./property.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function r(r){return t({...r,state:!0,attribute:!1})}export{r as state};\n//# sourceMappingURL=state.js.map\n","// AI types (using string for intents to avoid core dependency in types)\n\n/**\n * Custom event types for AI components\n */\n\nexport interface AiInvokeEventDetail {\n  intent: string;\n  context: unknown;\n}\n\nexport interface AiResultEventDetail {\n  intent: string;\n  result: any;\n}\n\nexport interface AiErrorEventDetail {\n  intent: string;\n  error: Error;\n}\n\n/**\n * Custom event classes\n */\nexport class AiInvokeEvent extends CustomEvent<AiInvokeEventDetail> {\n  constructor(detail: AiInvokeEventDetail) {\n    super('ai:invoke', {\n      detail,\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\nexport class AiResultEvent extends CustomEvent<AiResultEventDetail> {\n  constructor(detail: AiResultEventDetail) {\n    super('ai:result', {\n      detail,\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\nexport class AiErrorEvent extends CustomEvent<AiErrorEventDetail> {\n  constructor(detail: AiErrorEventDetail) {\n    super('ai:error', {\n      detail,\n      bubbles: true,\n      composed: true,\n    });\n  }\n}\n\n/**\n * Type augmentation for HTMLElementEventMap\n */\ndeclare global {\n  interface HTMLElementEventMap {\n    'ai:invoke': AiInvokeEvent;\n    'ai:result': AiResultEvent;\n    'ai:error': AiErrorEvent;\n  }\n}\n","import { LitElement, html, css } from 'lit';\nimport { customElement, property, state } from 'lit/decorators.js';\nimport { AiIntent, type AiResult, type AiClient } from '@cognivo/core';\nimport { baseStyles, animations } from '../../styles/base.js';\nimport { tokens } from '../../styles/tokens.js';\nimport { AiInvokeEvent, AiResultEvent, AiErrorEvent } from '../../types/events.js';\nimport '../ai-thinking-indicator/ai-thinking-indicator.js';\nimport '../ai-confidence-badge/ai-confidence-badge.js';\n\n/**\n * AI Insight Card\n *\n * The flagship component of Cognivo. Displays data with AI-powered insights.\n * Supports multiple AI actions (explain, forecast, detect anomalies, etc.)\n *\n * @element ai-insight-card\n *\n * @attr {string} title - Card title\n * @attr {array} ai-actions - Enabled AI actions: ['explain', 'forecast', 'detect_anomaly']\n *\n * @fires ai:invoke - Fired when an AI action is triggered\n * @fires ai:result - Fired when AI returns a result\n * @fires ai:error - Fired when AI encounters an error\n *\n * @slot - Default slot for data content\n * @slot actions - Custom action buttons\n * @slot ai-result - Custom AI result rendering\n *\n * @example\n * ```html\n * <ai-insight-card\n *   title=\"Monthly Spending\"\n *   ai-actions='[\"explain\", \"forecast\"]'\n * >\n *   <div>Your data visualization here</div>\n * </ai-insight-card>\n * ```\n */\n@customElement('ai-insight-card')\nexport class AiInsightCard extends LitElement {\n  static override styles = [\n    baseStyles,\n    animations,\n    css`\n      :host {\n        display: block;\n        background: inherit;\n        border-radius: var(--cg-Border-radius-150);\n        border-left: 4px solid inherit;\n        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n        overflow: hidden;\n        transition: box-shadow inherit;\n      }\n\n      :host(:hover) {\n        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n      }\n\n      .card-header {\n        padding: var(--cg-spacing-16);\n        border-bottom: 1px solid var(--cg-gray-100);\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        gap: var(--cg-spacing-16);\n      }\n\n      .card-title {\n        font-size: var(--cg-font-size-lg);\n        font-weight: inherit;\n        color: inherit;\n        margin: 0;\n      }\n\n      .card-content {\n        padding: var(--cg-spacing-16);\n      }\n\n      .ai-actions {\n        display: flex;\n        gap: var(--cg-spacing-8);\n        flex-wrap: wrap;\n      }\n\n      .ai-button {\n        display: inline-flex;\n        align-items: center;\n        gap: var(--cg-spacing-4);\n        padding: var(--cg-spacing-4) var(--cg-spacing-16);\n        background: inherit;\n        border: 1px solid inherit;\n        border-radius: var(--cg-Border-radius-100);\n        color: inherit;\n        font-size: var(--cg-font-size-sm);\n        font-weight: inherit;\n        cursor: pointer;\n        transition: all inherit;\n      }\n\n      .ai-button:hover {\n        background: inherit;\n        color: white;\n        transform: translateY(-1px);\n      }\n\n      .ai-button:active {\n        transform: translateY(0);\n      }\n\n      .ai-button:disabled {\n        opacity: 0.5;\n        cursor: not-allowed;\n        transform: none;\n      }\n\n      .ai-result {\n        margin-top: var(--cg-spacing-16);\n        padding: var(--cg-spacing-16);\n        background: inherit;\n        border: 1px solid inherit;\n        border-radius: var(--cg-Border-radius-100);\n        animation: fadeIn 0.3s ease-in-out;\n      }\n\n      .ai-result-header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: var(--cg-spacing-8);\n      }\n\n      .ai-result-title {\n        font-size: var(--cg-font-size-md);\n        font-weight: inherit;\n        color: inherit;\n      }\n\n      .ai-explanation {\n        margin: var(--cg-spacing-8) 0;\n        color: inherit;\n        line-height: 1.6;\n      }\n\n      .ai-bullets {\n        list-style: none;\n        padding: 0;\n        margin: var(--cg-spacing-8) 0;\n      }\n\n      .ai-bullets li {\n        padding: var(--cg-spacing-4) 0;\n        padding-left: var(--cg-spacing-16);\n        position: relative;\n      }\n\n      .ai-bullets li::before {\n        content: '•';\n        position: absolute;\n        left: 0;\n        color: inherit;\n        font-weight: bold;\n      }\n\n      .ai-drivers {\n        margin-top: var(--cg-spacing-16);\n      }\n\n      .driver {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: var(--cg-spacing-4);\n        margin: var(--cg-spacing-4) 0;\n        background: white;\n        border-radius: var(--cg-Border-radius-50);\n      }\n\n      .driver-factor {\n        font-weight: inherit;\n      }\n\n      .driver-impact {\n        display: flex;\n        align-items: center;\n        gap: var(--cg-spacing-4);\n        font-size: var(--cg-font-size-sm);\n        color: var(--cg-gray-500);\n      }\n\n      .loading-state {\n        display: flex;\n        align-items: center;\n        gap: var(--cg-spacing-8);\n        padding: var(--cg-spacing-16);\n        color: var(--cg-gray-500);\n      }\n\n      .error-state {\n        padding: var(--cg-spacing-16);\n        background: inherit;\n        color: white;\n        border-radius: var(--cg-Border-radius-100);\n        margin-top: var(--cg-spacing-16);\n      }\n\n      /* Dark theme support */\n      :host([data-theme='dark']) {\n        background: inherit;\n      }\n\n      :host([data-theme='dark']) .card-title,\n      :host([data-theme='dark']) .ai-result-title,\n      :host([data-theme='dark']) .ai-explanation {\n        color: inherit;\n      }\n    `,\n  ];\n\n  /**\n   * Card title\n   */\n  @property({ type: String })\n  override title = '';\n\n  /**\n   * Enabled AI actions\n   */\n  @property({ type: Array, attribute: 'ai-actions' })\n  aiActions: string[] = [];\n\n  /**\n   * Data to analyze (passed as property, not attribute)\n   */\n  @property({ type: Array })\n  data: unknown[] = [];\n\n  /**\n   * Metadata for AI context\n   */\n  @property({ type: Object })\n  meta: Record<string, unknown> = {};\n\n  /**\n   * AI client instance (injected via property or context)\n   */\n  @property({ attribute: false })\n  aiClient?: any;\n\n  /**\n   * Current AI result\n   */\n  @state()\n  private result: AiResult | null = null;\n\n  /**\n   * Loading state\n   */\n  @state()\n  private loading = false;\n\n  /**\n   * Error state\n   */\n  @state()\n  private error: Error | null = null;\n\n  /**\n   * Current active intent\n   */\n  @state()\n  private activeIntent: AiIntent | null = null;\n\n  /**\n   * Run an AI intent\n   */\n  private async runIntent(intent: AiIntent) {\n    if (!this.aiClient) {\n      this.error = new Error('No AI client provided. Set the aiClient property.');\n      return;\n    }\n\n    if (this.loading) {\n      return; // Already running\n    }\n\n    this.loading = true;\n    this.error = null;\n    this.activeIntent = intent;\n\n    // Dispatch invoke event\n    this.dispatchEvent(\n      new AiInvokeEvent({\n        intent,\n        context: { dataset: this.data, meta: this.meta },\n      })\n    );\n\n    try {\n      const result = await this.aiClient.runIntent(intent, {\n        dataset: this.data,\n        meta: this.meta,\n      });\n\n      this.result = result;\n\n      // Dispatch result event\n      this.dispatchEvent(\n        new AiResultEvent({\n          intent,\n          result,\n        })\n      );\n    } catch (err) {\n      this.error = err as Error;\n\n      // Dispatch error event\n      this.dispatchEvent(\n        new AiErrorEvent({\n          intent,\n          error: err as Error,\n        })\n      );\n    } finally {\n      this.loading = false;\n    }\n  }\n\n  /**\n   * Get label for intent\n   */\n  private getIntentLabel(intent: string): string {\n    const labels: Record<string, string> = {\n      explain: 'Explain',\n      forecast: 'Forecast',\n      detect_anomaly: 'Detect Anomalies',\n      summarize: 'Summarize',\n      classify: 'Classify',\n      optimize: 'Optimize',\n      compare: 'Compare',\n      cluster: 'Cluster',\n    };\n    return labels[intent] || intent;\n  }\n\n  override render() {\n    return html`\n      <div class=\"card\">\n        ${this.title\n          ? html`\n              <div class=\"card-header\">\n                <h3 class=\"card-title\">${this.title}</h3>\n              </div>\n            `\n          : null}\n\n        <div class=\"card-content\">\n          <!-- Data content slot -->\n          <slot></slot>\n\n          <!-- AI Actions -->\n          ${this.aiActions.length > 0\n            ? html`\n                <div class=\"ai-actions\">\n                  ${this.aiActions.map(\n                    (action) => html`\n                      <button\n                        class=\"ai-button\"\n                        @click=${() => this.runIntent(action as AiIntent)}\n                        ?disabled=${this.loading}\n                      >\n                        ✨ ${this.getIntentLabel(action)}\n                      </button>\n                    `\n                  )}\n                </div>\n              `\n            : null}\n\n          <!-- Loading State -->\n          ${this.loading\n            ? html`\n                <div class=\"loading-state\">\n                  <ai-thinking-indicator size=\"md\"></ai-thinking-indicator>\n                  <span>AI is analyzing...</span>\n                </div>\n              `\n            : null}\n\n          <!-- Error State -->\n          ${this.error\n            ? html`\n                <div class=\"error-state\">\n                  <strong>Error:</strong> ${this.error.message}\n                </div>\n              `\n            : null}\n\n          <!-- AI Result -->\n          ${this.result && !this.loading\n            ? html`\n                <div class=\"ai-result\">\n                  <slot name=\"ai-result\" .result=${this.result}>\n                    <div class=\"ai-result-header\">\n                      <span class=\"ai-result-title\">AI Insights</span>\n                      ${this.result.confidence\n                        ? html`\n                            <ai-confidence-badge\n                              score=${this.result.confidence}\n                              show-percentage\n                            ></ai-confidence-badge>\n                          `\n                        : null}\n                    </div>\n\n                    ${this.result.explanation\n                      ? html`<p class=\"ai-explanation\">${this.result.explanation}</p>`\n                      : null}\n\n                    ${this.result.bullets && this.result.bullets.length > 0\n                      ? html`\n                          <ul class=\"ai-bullets\">\n                            ${this.result.bullets.map((bullet: any) => html`<li>${bullet}</li>`)}\n                          </ul>\n                        `\n                      : null}\n\n                    ${this.result.drivers && this.result.drivers.length > 0\n                      ? html`\n                          <div class=\"ai-drivers\">\n                            <strong>Key Drivers:</strong>\n                            ${this.result.drivers.map(\n                              (driver: any) => html`\n                                <div class=\"driver\">\n                                  <span class=\"driver-factor\">${driver.factor}</span>\n                                  <span class=\"driver-impact\">\n                                    ${driver.impact > 0 ? '+' : ''}${driver.impact}% impact\n                                  </span>\n                                </div>\n                              `\n                            )}\n                          </div>\n                        `\n                      : null}\n                  </slot>\n                </div>\n              `\n            : null}\n        </div>\n      </div>\n    `;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'ai-insight-card': AiInsightCard;\n  }\n}\n"],"names":["r","t","AiInvokeEvent","detail","AiResultEvent","AiErrorEvent","AiInsightCard","LitElement","intent","result","err","html","action","bullet","driver","baseStyles","animations","css","__decorateClass","property","state","customElement"],"mappings":"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","x_google_ignoreList":[0]}